function chooseAirports(a){hideAll();var b=getPosition(a.currentTarget);$(".planes").css("top",b.y-4),$(".planes").show()}function distance(a,b,c,d){return 2*Math.asin(Math.sqrt(Math.pow(Math.sin((a-c)/2),2)+Math.cos(a)*Math.cos(c)*Math.pow(Math.sin((b-d)/2),2)))}function pathFraction(a,b,c){var d=Math.radians(a.split(",")[0]),e=Math.radians(a.split(",")[1]),f=Math.radians(b.split(",")[0]),g=Math.radians(b.split(",")[1]),h=distance(d,e,f,g),i=Math.sin((1-c)*h)/Math.sin(h),j=Math.sin(c*h)/Math.sin(h),k=i*Math.cos(d)*Math.cos(e)+j*Math.cos(f)*Math.cos(g),l=i*Math.cos(d)*Math.sin(e)+j*Math.cos(f)*Math.sin(g),m=i*Math.sin(d)+j*Math.sin(f),n=Math.atan2(m,Math.sqrt(Math.pow(k,2)+Math.pow(l,2))),o=Math.atan2(l,k);return[Math.degrees(o),Math.degrees(n)]}function traceFlightPrecision(a,b,c){var d=[];d.push(a.split(",").reverse());for(var e=1/c,f=0;1>f;f+=e)d.push(pathFraction(a,b,f));return d.push(b.split(",").reverse()),{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:d}}}function traceFlight(){$("#fromval").val()&&$("#toval").val()&&(window.simplifyLayerData=traceFlightPrecision($("#fromval").val(),$("#toval").val(),100),window.simplifyLayer=L.geoJson(window.simplifyLayerData,{style:window.style2}).addTo(window.map),window.layers[$("#from").val()+" -> "+$("#to").val()]=window.simplifyLayerData)}Math.radians=function(a){return a*Math.PI/180},Math.degrees=function(a){return 180*a/Math.PI},$(document).ready(function(){$(".autocomplete").autocomplete({serviceUrl:"http://wilkins.fr/airports/iata.php",onSelect:function(a){$("#"+this.id+"val").val(a.data),traceFlight()}})});