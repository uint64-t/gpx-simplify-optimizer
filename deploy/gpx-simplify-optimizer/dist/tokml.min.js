!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.tokml=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){function c(a){return function(b){var c="",d="";if(a.simplestyle&&p(b.properties)&&(c=m(b.properties),d=t("styleUrl","#"+q(b.properties))),!b.properties||!v.valid(b.geometry))return"";var e=v.any(b.geometry);return e?c+t("Placemark",g(b.properties,a)+h(b.properties,a)+k(b.properties)+i(b.properties,a)+e+d):""}}function d(a,b){if(!a.type)return"";switch(a.type){case"FeatureCollection":return a.features?a.features.map(c(b)).join(""):"";case"Feature":return c(b)(a);default:return c(b)({type:"Feature",geometry:a,properties:{}})}}function e(a){return void 0!==a.documentName?t("name",a.documentName):""}function f(a){return void 0!==a.documentDescription?t("description",a.documentDescription):""}function g(a,b){return a[b.name]?t("name",u(a[b.name])):""}function h(a,b){return a[b.description]?t("description",u(a[b.description])):""}function i(a,b){return a[b.timestamp]?t("TimeStamp",t("when",u(a[b.timestamp]))):""}function j(a){return a.map(function(a){return a.join(",")}).join(" ")}function k(a){return t("ExtendedData",r(a).map(l).join(""))}function l(a){return t("Data",t("value",u(a[1])),[["name",u(a[0])]])}function m(a){return t("Style",t("IconStyle",t("Icon",t("href",n(a))))+o(a),[["id",q(a)]])}function n(a){var b=a["marker-size"]||"medium",c=a["marker-symbol"]?"-"+a["marker-symbol"]:"",d=(a["marker-color"]||"7e7e7e").replace("#","");return"https://api.tiles.mapbox.com/v3/marker/pin-"+b.charAt(0)+c+"+"+d+".png"}function o(){return t("hotSpot","",[["xunits","fraction"],["yunits","fraction"],["x",.5],["y",.5]])}function p(a){return!!(a["marker-size"]||a["marker-symbol"]||a["marker-color"])}function q(a){return(a["marker-symbol"]||"")+(a["marker-color"]||"").replace("#","")+(a["marker-size"]||"")}function r(a){var b=[];for(var c in a)b.push([c,a[c]]);return b}var s=a("strxml"),t=s.tag,u=s.encode;b.exports=function(a,b){return b=b||{documentName:void 0,documentDescription:void 0,name:"name",description:"description",simplestyle:!1,timestamp:"timestamp"},'<?xml version="1.0" encoding="UTF-8"?>'+t("kml",t("Document",e(b)+f(b)+d(a,b)),[["xmlns","http://www.opengis.net/kml/2.2"]])};var v={Point:function(a){return t("Point",t("coordinates",a.coordinates.join(",")))},LineString:function(a){return t("LineString",t("coordinates",j(a.coordinates)))},Polygon:function(a){if(!a.coordinates.length)return"";var b=a.coordinates[0],c=a.coordinates.slice(1),d=t("outerBoundaryIs",t("LinearRing",t("coordinates",j(b)))),e=c.map(function(a){return t("innerBoundaryIs",t("LinearRing",t("coordinates",j(a))))}).join("");return t("Polygon",d+e)},MultiPoint:function(a){return a.coordinates.length?t("MultiGeometry",a.coordinates.map(function(a){return v.Point({coordinates:a})}).join("")):""},MultiPolygon:function(a){return a.coordinates.length?t("MultiGeometry",a.coordinates.map(function(a){return v.Polygon({coordinates:a})}).join("")):""},MultiLineString:function(a){return a.coordinates.length?t("MultiGeometry",a.coordinates.map(function(a){return v.LineString({coordinates:a})}).join("")):""},GeometryCollection:function(a){return t("MultiGeometry",a.geometries.map(v.any).join(""))},valid:function(a){return a&&a.type&&(a.coordinates||"GeometryCollection"===a.type&&a.geometries.every(v.valid))},any:function(a){return v[a.type]?v[a.type](a):""}}},{strxml:2}],2:[function(a,b){function c(a){return a&&a.length?" "+a.map(function(a){return a[0]+'="'+a[1]+'"'}).join(" "):""}function d(a,b){return"<"+a+c(b)+"/>"}function e(a,b,d){return"<"+a+c(d)+">"+b+"</"+a+">"}function f(a){return(null===a?"":a.toString()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}b.exports.attr=c,b.exports.tagClose=d,b.exports.tag=e,b.exports.encode=f},{}]},{},[1])(1)});